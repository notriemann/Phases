import numpy as np
from astropy import units as u
from astropy.time import Time

# Observation days, taken from Table 1 of Rickett et al 2014.
obs_day = [-3, 211, 311, 379, 467, 202, 203, 274, 312, 319,
           374, 378, 415, 451, 462, 505, 560]
obs_times = Time(53000, obs_day, format='mjd')

# Columns from Table 1: K0, Ks, Kc, Ks2, Kc2,
# with odd columns the values and even columns the uncertainties.
# The maximum is applied to avoid the single error of 0.

harmonics = {
    'value':np.array(
        [[ 4.264231e+00,  3.787793e+00,  4.763840e+00,  6.190328e+00,
         3.246642e+00,  9.603914e-01,  8.901574e-01,  9.199231e-01,
         1.346699e+00,  1.405664e+00,  9.123387e-01,  9.368297e-01,
         7.397248e-01,  8.424962e-01,  7.423938e-01,  5.383791e-01,
         2.923521e-01],
       [-3.251250e+00,  6.966235e-01, -3.626389e+00, -6.742435e+00,
        -1.568782e+00,  4.085589e-01,  2.916710e-01, -3.988013e-01,
        -1.234023e+00, -1.391697e+00, -1.015446e+00, -1.053011e+00,
        -7.986317e-01, -7.105843e-01, -6.033963e-01,  6.051358e-02,
         1.591318e-01],
       [-1.180047e-01, -1.784144e-02, -1.500727e-01, -4.321437e-02,
        -5.086903e-02,  1.212440e-01,  2.652911e-03,  3.157202e-02,
        -3.821069e-02, -6.423613e-02, -2.350540e-02, -1.590896e-02,
        -1.468455e-03, -1.871640e-02, -4.102251e-02, -4.972736e-04,
        -1.271164e-03],
       [ 1.280604e-01, -6.253406e-02,  1.657353e-01,  4.246440e-02,
         8.727681e-03, -1.010461e-01,  4.258344e-02, -5.955622e-02,
         3.738214e-02,  4.911372e-02,  2.742685e-02,  1.677754e-02,
         1.660949e-02,  4.778005e-02,  3.577370e-02,  8.527331e-03,
        -5.454333e-03],
       [-3.415595e+00, -3.507368e+00, -4.017603e+00, -4.403833e+00,
        -2.566099e+00, -1.066331e+00, -8.632843e-01, -8.438475e-01,
        -1.150750e+00, -1.127001e+00, -5.939754e-01, -6.157281e-01,
        -5.343573e-01, -6.729801e-01, -5.821960e-01, -4.927751e-01,
        -2.641675e-01]]),
    'error':np.array(
        [[0.07486594, 0.098229  , 0.1258009 , 0.1380447 , 0.07568428,
        0.08679394, 0.05201259, 0.05647965, 0.05732195, 0.04991414,
        0.05442989, 0.03435562, 0.0396296 , 0.03477601, 0.02159856,
        0.03031069, 0.0116539 ],
       [0.09774798, 0.1124805 , 0.1626945 , 0.1938855 , 0.1012979 ,
        0.1460179 , 0.06922508, 0.07508116, 0.06953221, 0.06708326,
        0.09147441, 0.05361606, 0.05899499, 0.05043172, 0.03043517,
        0.03963726, 0.01655793],
       [0.03258834, 0.02194244, 0.04607997, 0.06764597, 0.03451931,
        0.1190987 , 0.01361254, 0.02475999, 0.02020399, 0.02891877,
        0.04451183, 0.02144624, 0.03165924, 0.02037205, 0.01270984,
        0.01497518, 0.00497532],
       [0.05615509, 0.06558188, 0.0832088 , 0.08143171, 0.06448489,
        0.08864808, 0.04128417, 0.04231896, 0.03489913, 0.03890645,
        0.05214337, 0.0285456 , 0.0358656 , 0.02896919, 0.01647677,
        0.02535339, 0.01058335],
       [0.07567081, 0.1026954 , 0.1215713 , 0.1156776 , 0.0829325 ,
        0.1246748 , 0.05036399, 0.05768213, 0.05654815, 0.05450587,
        0.05592015, 0.03316357, 0.03804645, 0.03695122, 0.02407595,
        0.03532661, 0.01174288]])
    }

# ------------------------------------------------------------------------------
# Fitted values from Table 3 of Rickett et al 2014
# ------------------------------------------------------------------------------
fitvals = {
    90: {'i': 90. * u.deg,
         's': 0.71,
         'Oangle': 69 * u.deg,
         'R': 0.76,
         'PsiAR': 72 * u.deg,
         'VIS': [-12, 50] * u.km / u.s,
         's0': 4.2e6 * u.m,
         'dpsr': 1150 * u.pc},
    88: {'i': 88.7 * u.deg,
         's': 0.71,
         'Oangle': 61 * u.deg,
         'R': 0.71,
         'PsiAR': 61 * u.deg,
         'VIS': [-9, 42] * u.km / u.s,
         's0': 4.2e6 * u.m,
         'dpsr': 1150 * u.pc},
    91: {'i': 91.3 * u.deg,
         's': 0.70,
         'Oangle': 111 * u.deg,
         'R': 0.96,
         'PsiAR': 118 * u.deg,
         'VIS': [-79, 100] * u.km / u.s,
         's0': 4.2e6 * u.m,
         'dpsr': 1150 * u.pc}
}


# ------------------------------------------------------------------------------
# New fitted values based on Kramer et al 2021 inclination and distance
# Note: will need updated .par file with these fits
# ------------------------------------------------------------------------------

fitvals[8935] = {'i': 89.35 * u.deg,
         's': 0.64643337,
         'Oangle': 41.8782435 * u.deg,
         'R': 0.8724296,
         'PsiAR': 43.31625725 * u.deg,
         'VIS': [15.699612, 49.926273] * u.km / u.s,
         's0': 4.2e6 * u.m,
         'dpsr': 735 * u.pc}

fitvals[9065] = {'i': 90.65 * u.deg,
         's': 0.67503342,
         'Oangle': 118.87282862 * u.deg,
         'R': 0.92213744,
         'PsiAR': 126.63393181 * u.deg,
         'VIS': [-75.457545, 68.507061] * u.km / u.s,
         's0': 4.2e6 * u.m,
         'dpsr': 735 * u.pc}

fitvals[8783] = {'i': 87.82970787 * u.deg,
         's': 0.70771523,
         'Oangle': 69.13707903 * u.deg,
         'R': 0.76381646,
         'PsiAR': 72.83557006 * u.deg,
         'VIS': [-10.422411, 52.085925] * u.km / u.s,
         's0': 4.2e6 * u.m,
         'dpsr': 735 * u.pc}